<%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<c:set var="ctx" value="${pageContext.request.contextPath}" />
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>燃料供应-计划分析</title>
  <link rel="stylesheet" href="${ctx}/font-awesome/css/font-awesome.css">
  <link rel="stylesheet" href="${ctx}/bi/css/style.css">
  <link rel="stylesheet" href="${ctx}/bi/css/jhfx.css">
  <!--日期样式 -->
    <link rel="stylesheet" href="${ctx}/css/bootstrap.min.css">
    <link rel="stylesheet" href="${ctx}/css/plugins/datapicker/datepicker3.css">
</head>

<body>
  <div class="hd">
    <div class="level">
      <i class="fa fa-map-marker"></i>
      <p class="lev_tit" id="reporttitle">燃料供应 > 计划分析</p>
    </div>
    <div class="param">
      <div name="group" id="p_group">
        <p></p>
        <span><i class="fa fa-sitemap"></i></span>
      </div>
      <div class="form-group" style="margin-bottom: 5px;">
        <div id="data_YM" style="width:205px;">
            <div class="input-group date">
                <span class="input-group-addon" id="p_icon2">
                    <i class="fa fa-calendar"></i>
                </span>
                <input type="text" readonly="readonly" class="form-control" value="" id="dateYM">
            </div>
        </div>
    </div>
      <div class="query">查询</div>
    </div>
  </div>
  <div class="menu">
    <div class="tab active">
      <p>
        <i class="fa fa-globe"></i>&nbsp&nbsp计划概览</p>
    </div>
    <div class="tab">
      <p>
        <i class="fa fa-map" aria-hidden="true"></i>&nbsp&nbsp计划兑现</p>
    </div>
    <div class="tab">
      <p>
        <i class="fa fa-truck"></i>&nbsp&nbsp计划到货</p>
    </div>
  </div>
  <div class="main active">
    <div class="content active" id="gl">
      <div class="top">
        <div class="tl">
          <div class="tll" id="pie_1"></div>
          <div class="tlr">
            <p class="tlr_tit">计划采购量（万吨）</p>
            <p class="p_1">月度计划
              <span>0.00</span>
            </p>
            <p class="p_2">临购计划
              <span>0.00</span>
            </p>
          </div>
        </div>
        <div class="tr">
          <div class="trl" id="pie_2"></div>
          <div class="trr">
            <p class="trr_tit">计划采购量（万吨）</p>
            <p class="p_1">长协
              <span>0.00</span>
            </p>
            <p class="p_2">现货
              <span>0.00</span>
            </p>
          </div>
        </div>
      </div>
      <div class="middle">
        <div class="bar" id="bar_1"></div>
        <div class="bar" id="bar_2"></div>
        <div class="bar" id="bar_3"></div>
        <div class="bar" id="bar_4"></div>
      </div>
      <div class="bottom">
        <table>
          <thead>
            <tr>
              <td></td>
              <td>计划采购量</td>
              <td>计划热值</td>
              <td>计划到厂价</td>
              <td>计划采购标煤单价</td>
              <td>计划硫份</td>
            </tr>
          </thead>
          <tbody>
            <tr class="hj">
            </tr>
            <tr class="cx">
            </tr>
            <tr class="xh">
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="content" id="dx">
      <div class="top">
        <div class="tl" id="pie_3"></div>
        <div class="tr">
          <p>单位：万吨</p>
          <table>
            <thead>
              <tr>
                <td></td>
                <td>计划采购量</td>
                <td>已兑现量</td>
                <td>未兑现量</td>
                <td>计划兑现率</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>长协</td>
                <td>629.86</td>
                <td>332.02</td>
                <td>297.84</td>
                <td>52.71%</td>
              </tr>
              <tr>
                <td>现货</td>
                <td>386.65</td>
                <td>132.10</td>
                <td>254.55</td>
                <td>34.17%</td>
              </tr>
              <tr>
                <td>合计</td>
                <td>1016.51</td>
                <td>464.12</td>
                <td>552.39</td>
                <td>45.66%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="middle">
        <div class="ml" id="bar_5"></div>
        <div class="mr">
          <p>安徽-计划兑现情况</p>
          <table>
            <thead>
              <tr>
                <td></td>
                <td>计划采购量</td>
                <td>已兑现量</td>
                <td>未兑现量</td>
                <td>计划兑现率</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>长协</td>
                <td>629.86</td>
                <td>332.02</td>
                <td>297.84</td>
                <td>52.71%</td>
              </tr>
              <tr>
                <td>现货</td>
                <td>386.65</td>
                <td>132.10</td>
                <td>254.55</td>
                <td>34.17%</td>
              </tr>
              <tr>
                <td>合计</td>
                <td>1016.51</td>
                <td>464.12</td>
                <td>552.39</td>
                <td>45.66%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="bottom">
        <div class="bl" id="bar_6"></div>
        <div class="br">
          <p>安源-计划兑现情况</p>
          <table>
            <thead>
              <tr>
                <td></td>
                <td>计划采购量</td>
                <td>已兑现量</td>
                <td>未兑现量</td>
                <td>计划兑现率</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>长协</td>
                <td>629.86</td>
                <td>332.02</td>
                <td>297.84</td>
                <td>52.71%</td>
              </tr>
              <tr>
                <td>现货</td>
                <td>386.65</td>
                <td>132.10</td>
                <td>254.55</td>
                <td>34.17%</td>
              </tr>
              <tr>
                <td>合计</td>
                <td>1016.51</td>
                <td>464.12</td>
                <td>552.39</td>
                <td>45.66%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
   </div>
    <div class="content" id="dh">
    	<div class="top">
        <div class="tl" id="pie_4"></div>
        <div class="tr">
          <p>单位：万吨</p>
          <table>
            <thead>
              <tr>
                <td></td>
                <td>计划采购量</td>
                <td>已到货</td>
                <td>未到货</td>
                <td>到货率</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>长协</td>
                <td>629.86</td>
                <td>332.02</td>
                <td>297.84</td>
                <td>52.71%</td>
              </tr>
              <tr>
                <td>现货</td>
                <td>386.65</td>
                <td>132.10</td>
                <td>254.55</td>
                <td>34.17%</td>
              </tr>
              <tr>
                <td>合计</td>
                <td>1016.51</td>
                <td>464.12</td>
                <td>552.39</td>
                <td>45.66%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="middle">
        <div class="ml" id="bar_7"></div>
        <div class="mr">
          <p>安徽-计划兑现情况</p>
          <table>
            <thead>
              <tr>
                <td></td>
                <td>计划采购量</td>
                <td>已到货</td>
                <td>未到货</td>
                <td>到货率</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>长协</td>
                <td>629.86</td>
                <td>332.02</td>
                <td>297.84</td>
                <td>52.71%</td>
              </tr>
              <tr>
                <td>现货</td>
                <td>386.65</td>
                <td>132.10</td>
                <td>254.55</td>
                <td>34.17%</td>
              </tr>
              <tr>
                <td>合计</td>
                <td>1016.51</td>
                <td>464.12</td>
                <td>552.39</td>
                <td>45.66%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="bottom">
        <div class="bl" id="bar_8"></div>
        <div class="br">
          <p>安源-计划兑现情况</p>
          <table>
            <thead>
              <tr>
                <td></td>
                <td>计划采购量</td>
                <td>已到货</td>
                <td>未到货</td>
                <td>到货率</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>长协</td>
                <td>629.86</td>
                <td>332.02</td>
                <td>297.84</td>
                <td>52.71%</td>
              </tr>
              <tr>
                <td>现货</td>
                <td>386.65</td>
                <td>132.10</td>
                <td>254.55</td>
                <td>34.17%</td>
              </tr>
              <tr>
                <td>合计</td>
                <td>1016.51</td>
                <td>464.12</td>
                <td>552.39</td>
                <td>45.66%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
 
   <div class="popup-inform">
        <iframe id="subframe" src="" frameborder="no" border="0" scrolling="no" style="display: inline;"></iframe>
    </div>
  
<!-- loading -->
	<div class="modal fade" id="myloading" tabindex="1" role="dialog" data-backdrop="static" aria-labelledby="myModalLabel" aria-hidden="true">
	  <div class="my-modal-dialog" >
	      <img src="${ctx}/img/loading3.gif" >
	      <p>正在加载...</p>
	  </div>
	</div>
</body>

</html>
<script src="${ctx}/js/jquery-2.1.1.js"></script>
<script src="${ctx}/js/echarts/font.js"></script>
<script src="${ctx}/js/echarts/echarts.js"></script>
 <!-- 日期js -->
    <script src="${ctx}/js/plugins/datapicker/bootstrap-datepicker.js"></script>
<script>

  	var key='${KEY}';
  	var weburl='${WEBURL}';
	var orgname='${ORGNAME}'; 
  	var orgcode='${ORGCODE}'; //---------公司编码
 	var dateInfo;
  	//console.log(orgcode,orgname)
  	
   //-------------------窗口加载----------------------
  $(window).ready(function () {
    var W_w = $(window).width();
    var W_h = $(window).height();
    $('body').width(W_w);
    $('body').height(W_h);
   	$("#p_group>p").text(orgname);
   	$(function(){
   		dateInfo=($("#dateYM").val()).replace("-","");
  	  	refreshData(weburl,orgcode,dateInfo);
   	})
    drawPie3(pieData_3);
   	drawBar5(barData_5);
   	drawBar6(barData_6);

    drawBar7(barData_5);
    drawBar8(barData_6);

    drawPie4(pieData_3);
  })
  
  //-------------------窗口尺寸变化------------------------
    $(window).resize(function () {
    var W_w = $(window).width();
    var W_h = $(window).height();
    $('body').width(W_w);
    $('body').height(W_h);
  })

  //-----------------集团参数点击事件------------------------
  $("#p_group span").click(function () {
	  	
    	$(".popup-inform").show();
    	$("#subframe").attr("src", "${ctx}/comp/orgwithauth.shtml");
    });
  
  $("#p_group").click(function(){
	  
  	$(".popup-inform").show();
  	$("#subframe").attr("src", "${ctx}/comp/orgwithauth.shtml");
  });
    
    function closeOrg(id,name) {
    	orgcode=id;
    	$("#subframe").attr("src", "");
    	$(".popup-inform").hide();
    	$("#p_group>p").html(name);
    	
    }

    function close2() {
    	$("#subframe").attr("src", "");
    	$(".popup-inform").hide();
    }
  
 // -----------------年月参数调用---------------------------------
    $(function () {
        $('#data_YM .input-group.date').datepicker({
            minViewMode: 1,
            format: 'yyyy-mm',
            keyboardNavigation: false,
            forceParse: false,
            autoclose: true,
            // todayHighlight: true
        });
        var nowdate = new Date();
        var y = nowdate.getFullYear();
        var m = nowdate.getMonth();//获取当前月份的日期 
        if (m == 0) {
            $('#dateYM').val(y - 1 + "-12");
        } else {
            $('#dateYM').val(y + "-" + (m < 10 ? '0' + m : m));
        }
    });
 
  //---------------------tab标签切换--------------------------------
  $(".tab").click(function () {
    var idx = $(this).index();
    $(this).addClass("active").siblings().removeClass("active");
    $(".content").eq(idx).addClass("active").siblings().removeClass("active");
  })
  
  //-------------------点击查询按钮------------------------
  $(".query").click(function(){
	  dateInfo=($("#dateYM").val()).replace("-","");
	  console.log(dateInfo)
	  refreshData(weburl,orgcode,dateInfo);
	  //console.log(dateInfo)
  })

  //-------------------获取数据------------------------
   function refreshData(weburl,orgcode,dateInfo){
    	$.ajax({
            url: 
            	weburl+"HN/ODATA/RL/ZHN_XS_PROJECT01/ZO_CV_RL_YDCGJH.xsodata/"
            	+"IP("
            	+"I_DATEF='"+dateInfo+"',"
            	+"I_DATET='"+dateInfo+"',"
            	+"I_WDHZ='4',"
            	+"I_HIENM='ZHNRL_01',"
            	+"I_HIDATE='99991231',"
            	+"I_MXBS='3',"
            	+"I_JHFL='',"
            	+"I_BBLB='A',"
            	+"I_JHHXD='',"
            	+"I_YJHHXD='',"
            	+"I_JHGLV='1',"
            	+"I_NODENAME='"
            	+orgcode
            	+"')/Results?$format=json",	
            			
            method : 'GET',
            dataType: "json",
            xhrFields: {withCredentials: true},
            headers:{"Accept" : "application/json",'Authorization':'Basic '+key},
            success: function (data){
                var dataarry = data.d.results;
                var pieData_1 = [];
                $.each(dataarry,function(i,d){

        			var piedata = {};
        			if(d.PLATY=="RMYD"){
            			var ydjh=d.BQJHL;
            			$(".tlr>.p_1>span").text(ydjh);
            			piedata.name="月度计划";
            			piedata.value=ydjh;
            			pieData_1.push(piedata)
        			}
        			if(d.PLATY=="RMLG"){

            			var lgjh;
        				if(d.BQJHL==""){
        					lgjh=0;
        				}else{
        					lgjh=d.BQJHL;
        				}
            			$(".tlr>.p_2>span").text(lgjh);
            			piedata.name="临购计划";
            			piedata.value=lgjh;
            			pieData_1.push(piedata)
            		}
        			console.log(pieData_1)
        			drawPie1(pieData_1);
            	});
            },
            error: function(data){
                console.log(data);
            }
        });
	  $.ajax({
          url: 
          	weburl+"HN/ODATA/RL/ZHN_XS_PROJECT01/ZO_CV_RL_YDCGJH.xsodata/"
          	+"IP("
          	+"I_DATEF='"+dateInfo+"',"
          	+"I_DATET='"+dateInfo+"',"
          	+"I_WDHZ='1',"
          	+"I_HIENM='ZHNRL_01',"
          	+"I_HIDATE='99991231',"
          	+"I_MXBS='3',"
          	+"I_JHFL='',"
          	+"I_BBLB='A',"
          	+"I_JHHXD='',"
        	+"I_YJHHXD='',"
        	+"I_JHGLV='1',"
          	+"I_NODENAME='"
          	+orgcode
          	+"')/Results?$format=json",	
          			
          method : 'GET',
          dataType: "json",
          xhrFields: {withCredentials: true},
          headers:{"Accept" : "application/json",'Authorization':'Basic '+key},
          success: function (data){
              var dataarry = data.d.results;
              console.log(dataarry)
              var xData = [];
              var yData1 = [];
              var yData2 = [];
              var yData3 = [];
              var yData4 = [];
              var pieData_2 = [];
          
              $.each(dataarry,function(i,d){
            	  if(d.CTYPE_MS!=""){
            			var piedata = {};
            			piedata.name = d.CTYPE_MS;
            			piedata.value = d.BQJHL;
            			pieData_2.push(piedata );
            	  }
        		drawPie2(pieData_2);
        		
        		if(d.CTYPE_MS=="长协"){
        			var cx=d.BQJHL;
        			$(".trr>.p_1>span").text(cx);
        			xData.push(d.CTYPE_MS);
        			$(".cx>td").remove();
	          		$(".cx").append("<td>其中：长协</td><td>"+d.BQJHL+"</td><td>"+d.JHRZL+"</td><td>"+d.DCPRI+"</td><td>"+d.DSPRI+"</td><td>"+d.PER04+"</td>")
    			}
    			if(d.CTYPE_MS=="现货"){
        			var xh=d.BQJHL;
        			$(".trr>.p_2>span").text(xh);
        			xData.push(d.CTYPE_MS);
        			$(".xh>td").remove();
	          		$(".xh").append("<td>其中：现货</td><td>"+d.BQJHL+"</td><td>"+d.JHRZL+"</td><td>"+d.DCPRI+"</td><td>"+d.DSPRI+"</td><td>"+d.PER04+"</td>")
        		}
          		yData1.push(d.JHRZL);
          		yData2.push(d.DCPRI);
          		yData3.push(d.DSPRI);
          		yData4.push(d.PER04);
          		console.log(xData);
				if(d.CTYPE_MS==""){
        			xData.push("合计");
	            	$(".hj>td").remove();
	          		$(".hj").append("<td>合计</td><td>"+d.BQJHL+"</td><td>"+d.JHRZL+"</td><td>"+d.DCPRI+"</td><td>"+d.DSPRI+"</td><td>"+d.PER04+"</td>")
				}
                        
          	});
              drawBar1(xData,yData1);
              drawBar2(xData,yData2);
              drawBar3(xData,yData3);
              drawBar4(xData,yData4);
          },
          error: function(data){
              console.log(data);
          }
      }); 
    }
  

//-----------------------以下为模拟数据--------------------------------//

  var pieData_3 = [
    { name: "长协", value: 629.86 },
    { name: "现货", value: 386.65 }
  ];
  var pieData_4 = [
    { name: "长协", value: 629.86 },
    { name: "现货", value: 386.65 }
  ];

  	var barData_5 = {
		xdata: ["福建","浙江", "上海","海南","辽宁", "河北"],
		ydata: [84,94,86,66,88,90,74]
		}
	var barData_6 = {
		xdata: ["长兴","安源", "井冈山","海口","营口", "汕头"],
		ydata: [84,94,86,87,88,90,74]
		}
  

//-----------------------以下为第一页图表--------------------------------//
//-----------------------第一页饼图1--------------------------------//
  var drawPie1 = function (datainfo) {
    var myChart = echarts.init(document.getElementById("pie_1"));
    var option = {
      color: ["#78BDFF", "#A6D5FF"],
      tooltip: {
        trigger: 'item',
        formatter: "{b} <br/>{c} ({d}%)"
      },
      legend: {
        orient: 'vertical',
        x: '10%',
        y: 'middle',
        textStyle: {
          fontSize: "80%",
        }
      },
      series: [
        {
          type: 'pie',
          radius: '80%',
          center: ['60%', '50%'],
          data: datainfo,
          label: {
            normal: {
              show: true,
              position: 'inside',
              formatter: "{b}\n{d}%",
              textStyle: {
                fontSize: "80%"
              }
            },
          },

        }
      ]
    };
    myChart.setOption(option);
    window.addEventListener("resize", function () {
      myChart.resize();
    });
  }
//-----------------------第一页饼图2--------------------------------//
  var drawPie2 = function (datainfo) {
    var myChart = echarts.init(document.getElementById("pie_2"));
    var option = {
      color: ["#F2EC23", "#ABEE6F"],
      tooltip: {
        trigger: 'item',
        formatter: "{b} <br/>{c} ({d}%)"
      },
      legend: {
        orient: 'vertical',
        x: '10%',
        y: 'middle',
        textStyle: {
          fontSize: "80%",
        }

      },
      series: [
        {
          type: 'pie',
          radius: '80%',
          center: ['60%', '50%'],
          data: datainfo,
          label: {
            normal: {
              show: true,
              position: 'inside',
              formatter: "{b}\n{d}%",
              textStyle: {
                fontSize: "80%"
              }
            },
          },
        }
      ]
    };
    myChart.setOption(option);
    window.addEventListener("resize", function () {
      myChart.resize();
    });
  }
//-----------------------第一页柱图1--------------------------------//
  var drawBar1 = function (xdata,ydata) {
    var myChart = echarts.init(document.getElementById("bar_1"));
    var option = {
      title: {
        text: '计划热值',
        subtext: '（大卡/千克）',
        x: 'center',
        y: '2%',
        textStyle: {
          fontSize: "120%",
        },
        subtextStyle: {
          fontSize: "80%",
        }
      },
      legend: {
        show: true,
        top: '60',
        data: ["合计", "长协", "现货"],
        textStyle: {
          fontSize: "80%"
        }
      },
      tooltip: {
        trigger: 'axis',
        axisPointer: {            // 坐标轴指示器，坐标轴触发有效
          type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
        }
      },
      grid: {
        left: '5%',
        right: '5%',
        top: '25%',
        bottom: '6%',
        containLabel: true
      },
      xAxis:
        {
          data:xdata,
          axisTick: {
            show: false
          },
          axisLabel: {
            fontSize: "80%"
          }
        }
      ,
      yAxis:
        {
          type: 'value',
          scale: true,
          axisTick: {
            show: false
          },
          axisLabel: {
            fontSize: "80%"
          }
        }
      ,
      series: [
        {
          type: 'bar',
          barWidth: '40%',
          data: ydata,
          label:{
            show:true,
            fontSize:"80%",
            position:"top"
          },
          color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
            offset: 0,
            color: '#F0F565'
          }, {
            offset: 1,
            color: '#CED256'
          }]),
        },
      ]
    };
    myChart.setOption(option);
    window.addEventListener("resize", function () {
      myChart.resize();
    });
  }

//-----------------------第一页柱图2--------------------------------//
  var drawBar2 = function (xdata,ydata) {
    var myChart = echarts.init(document.getElementById("bar_2"));
    var option = {
      title: {
        text: '计划到厂价',
        subtext: '（元/吨）',
        x: 'center',
        y: '2%',
        textStyle: {
          fontSize: "120%",
        },
        subtextStyle: {
          fontSize: "80%",
        }
      },
      color: ["#DEE25D", "#A1E960", "#69A6E0"],
      tooltip: {
        trigger: 'axis',
        axisPointer: {            // 坐标轴指示器，坐标轴触发有效
          type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
        }
      },
      grid: {
        left: '5%',
        right: '5%',
        top: '25%',
        bottom: '6%',
        containLabel: true
      },
      xAxis:
        {
          data: xdata,
          axisTick: {
            show: false
          },
          axisLabel: {
            fontSize: "80%"
          }
        }
      ,
      yAxis:
        {
          type: 'value',
          scale: true,
          axisTick: {
            show: false
          },
          axisLabel: {
            fontSize: "80%"
          }
        }
      ,
      series: [
        {
          name: "计划到厂价",
          type: 'bar',
          barWidth: '40%',
          data: ydata,
          label:{
            show:true,
            fontSize:"80%",
            position:"top"
          },
          color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
            offset: 0,
            color: '#A9F565'
          }, {
            offset: 1,
            color: '#91D256'
          }]),
        }
      ]
    };
    myChart.setOption(option);
    window.addEventListener("resize", function () {
      myChart.resize();
    });
  }

//-----------------------第一页柱图3--------------------------------//
  var drawBar3 = function (xdata,ydata) {
    var myChart = echarts.init(document.getElementById("bar_3"));
    var option = {
      title: {
        text: '计划采购标煤单价',
        subtext: '（元/吨）',
        x: 'center',
        y: '2%',
        textStyle: {
          fontSize: "120%",
        },
        subtextStyle: {
          fontSize: "80%",
        }
      },
      tooltip: {
        trigger: 'axis',
        axisPointer: {            // 坐标轴指示器，坐标轴触发有效
          type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
        }
      },
      grid: {
        left: '5%',
        right: '5%',
        top: '25%',
        bottom: '6%',
        containLabel: true
      },
      xAxis:
        {
          data: xdata,
          axisTick: {
            show: false
          },
          axisLabel: {
            fontSize: "80%"
          }
        }
      ,
      yAxis:
        {
          type: 'value',
          scale: true,
          axisTick: {
            show: false
          },
          axisLabel: {
            fontSize: "80%"
          }
        }
      ,
      series: [
        {
          name: "计划热值",
          type: 'bar',
          barWidth: '40%',
          data: ydata,
          label:{
            show:true,
            fontSize:"80%",
            position:"top"
          },
          color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
            offset: 0,
            color: '#F5BE65'
          }, {
            offset: 1,
            color: '#D2A556'
          }]),
        }
      ]
    };
    myChart.setOption(option);
    window.addEventListener("resize", function () {
      myChart.resize();
    });
  }

//-----------------------第一页柱图4--------------------------------//
  var drawBar4 = function (xdata,ydata) {
    var myChart = echarts.init(document.getElementById("bar_4"));
    var option = {
      title: {
        text: '计划硫份',
        subtext: '（%）',
        x: 'center',
        y: '2%',
        textStyle: {
          fontSize: "120%",
        },
        subtextStyle: {
          fontSize: "80%",
        }
      },
      tooltip: {
        trigger: 'axis',
        axisPointer: {            // 坐标轴指示器，坐标轴触发有效
          type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
        }
      },
      grid: {
        left: '5%',
        right: '5%',
        top: '25%',
        bottom: '6%',
        containLabel: true
      },
      xAxis:
        {
          data: xdata,
          axisTick: {
            show: false
          },
          axisLabel: {
            fontSize: "80%"
          }
        }
      ,
      yAxis:
        {
          type: 'value',
          scale: true,
          axisTick: {
            show: false
          },
          axisLabel: {
            fontSize: "80%"
          }
        }
      ,
      series: [
        {
          name: "计划热值",
          type: 'bar',
          barWidth: '40%',
          data: ydata,
          label:{
            show:true,
            fontSize:"80%",
            position:"top"
          },
          color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
            offset: 0,
            color: '#65E0F5'
          }, {
            offset: 1,
            color: '#56C6D3'
          }]),
        }
      ]
    };
    myChart.setOption(option);
    window.addEventListener("resize", function () {
      myChart.resize();
    });
  }


//-----------------------以下为第二页图表--------------------------------//
//-----------------------第二页饼图1--------------------------------//
var drawPie3 = function (datainfo) {
    var myChart = echarts.init(document.getElementById("pie_3"));
    var option = {
      color: ["#E2E563", "#7CC9F6"],
      tooltip: {
        trigger: 'item',
        formatter: "{b} <br/>{c} ({d}%)"
      },
      legend: {
        orient: 'vertical',
        x: '10%',
        y: 'middle',
        textStyle: {
          fontSize: "80%",
          fontFamily:"微软雅黑"
        }
   },
      series: [
        {
          type: 'pie',
          radius: '80%',
          center: ['60%', '50%'],
          data: datainfo,
          label: {
            normal: {
              show: true,
              position: 'inside',
              formatter: "{b}"+"："+"{d}%",
              textStyle: {
                fontSize: "80%",
                fontFamily:"微软雅黑"
              }
            },
          },

        }
      ]
    };
    myChart.setOption(option);
    window.addEventListener("resize", function () {
      myChart.resize();
    });
    
  }

//-----------------------第二页柱图1--------------------------------//
var drawBar5 = function (datainfo) {
    var myChart = echarts.init(document.getElementById("bar_5"));
    var option = {
      title: {
        text: '各分公司计划兑现率情况',
        x: 'center',
        y: '5%',
        textStyle: {
          fontSize: "120%",
        },
        subtextStyle: {
          fontSize: "80%",
        }
      },
      tooltip: {
        trigger: 'axis',
        axisPointer: {            // 坐标轴指示器，坐标轴触发有效
          type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
        }
      },
      grid: {
        left: '4%',
        right: '2%',
        top: '25%',
        bottom: '6%',
        containLabel: true
      },
      xAxis:
        {
          data: datainfo.xdata,
          axisTick: {
            show: false
          },
          axisLabel: {
            fontSize: "80%",
            fontFamily:"微软雅黑"
          }
        }
      ,
      yAxis:
        {
          type: 'value',
          scale: true,
          axisTick: {
            show: false
          },
          axisLabel: {
            fontSize: "80%",
            formatter:'{value} %'
          }
        }
      ,
      series: [
        {
          name: "兑现率",
          type: 'bar',
          barWidth: '10%',
          data: datainfo.ydata,
          label:{
            show:true,
            fontSize:"80%",
            position:"top",
            formatter:'{c} %'
          },
          color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
            offset: 0,
            color: '#65E0F5'
          }, {
            offset: 1,
            color: '#56C6D3'
          }]),
        }
      ]
    };
    myChart.setOption(option);
    window.addEventListener("resize", function () {
      myChart.resize();
    });  
    
    //-------------------------柱子点击变色并传参---------------
    myChart.on('click', function (params) {

      //console.log(params);

      var index = params.dataIndex;
      var name = params.name;
      //console.log(datainfo.ydata[i] )

      for (var i = 0; i < datainfo.ydata.length; i++) {
        if (datainfo.ydata[i].value) {
          datainfo.ydata[i] = datainfo.ydata[i].value;
        }
        if (index == i) {
          datainfo.ydata[i] = {
            value: datainfo.ydata[i],
            itemStyle: {
              normal: {
                color:'#F1A267'
              }
            }
          }
        }
      }

      //console.log(datainfo.ydata);
      option.series[0].data = datainfo.ydata
      myChart.setOption(option, true);
    })
  }

//-----------------------第二页柱图2--------------------------------//
  var drawBar6 = function (datainfo) {
    var myChart = echarts.init(document.getElementById("bar_6"));
    var option = {
      title: {
        text: '2018-03各电厂计划兑现率情况',
        x: 'center',
        y: '5%',
        textStyle: {
          fontSize: "120%",
        }
      },
      tooltip: {
        trigger: 'axis',
        axisPointer: {            // 坐标轴指示器，坐标轴触发有效
          type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
        }
      },
      grid: {
        left: '4%',
        right: '2%',
        top: '25%',
        bottom: '16%',
        containLabel: true
      },
      xAxis:
        {
          data: datainfo.xdata,
          axisTick: {
            show: false
          },
          axisLabel: {
            fontSize: "80%",
            rotate:90
          }
        }
      ,
      yAxis:
        {
          type: 'value',
          scale: true,
          axisTick: {
            show: false
          },
          axisLabel: {
            fontSize: "80%",
            formatter:'{value} %'
          }
        }
      ,
      series: [
        {
          name: "兑现率",
          type: 'bar',
          barWidth: '10%',
          data: datainfo.ydata,
          label:{
            show:true,
            fontSize:"80%",
            position:"top",
            formatter:'{c} %'
          },
          color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
            offset: 0,
            color: '#65E0F5'
          }, {
            offset: 1,
            color: '#56C6D3'
          }]),
        }
      ]
    };
    myChart.setOption(option);
    window.addEventListener("resize", function () {
      myChart.resize();
    });
    
  //-------------------------柱子点击变色并传参---------------
    myChart.on('click', function (params) {

      //console.log(params);

      var index = params.dataIndex;
      var name = params.name;
      //console.log(datainfo.ydata[i] )

      for (var i = 0; i < datainfo.ydata.length; i++) {
        if (datainfo.ydata[i].value) {
          datainfo.ydata[i] = datainfo.ydata[i].value;
        }
        if (index == i) {
          datainfo.ydata[i] = {
            value: datainfo.ydata[i],
            itemStyle: {
              normal: {
                color:'#F1A267'
              }
            }
          }
        }
      }

      //console.log(datainfo.ydata);
      option.series[0].data = datainfo.ydata
      myChart.setOption(option, true);
    })
  }




//-----------------------以下为第三页图表--------------------------------//

  var drawPie4 = function (datainfo) {
      var myChart = echarts.init(document.getElementById("pie_4"));
      var option = {
        color: ["#E2E563", "#7CC9F6"],
        tooltip: {
          trigger: 'item',
          formatter: "{b} <br/>{c} ({d}%)"
        },
        legend: {
          orient: 'vertical',
          x: '10%',
          y: 'middle',
          textStyle: {
            fontSize: "80%",
            fontFamily:"微软雅黑"
          }
        },
        series: [
          {
            type: 'pie',
            radius: '80%',
            center: ['60%', '50%'],
            data: datainfo,
            label: {
              normal: {
                show: true,
                position: 'inside',
                formatter: "{b}"+"："+"{d}%",
                textStyle: {
                  fontSize: "80%"
                }
              },
            },

          }
        ]
      };
      myChart.setOption(option);
      window.addEventListener("resize", function () {
        myChart.resize();
      });
    }
  var drawBar7 = function (datainfo,ym) {
      var myChart = echarts.init(document.getElementById("bar_7"));
      var option = {
        title: {
          text: '2018-03各分公司到货率情况',
          x: 'center',
          y: '5%',
          textStyle: {
            fontSize: "120%",
          },
          subtextStyle: {
            fontSize: "80%",
          }
        },
        tooltip: {
          trigger: 'axis',
          axisPointer: {            // 坐标轴指示器，坐标轴触发有效
            type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
          }
        },
        grid: {
          left: '4%',
          right: '2%',
          top: '25%',
          bottom: '6%',
          containLabel: true
        },
        xAxis:
          {
            data: datainfo.xdata,
            axisTick: {
              show: false
            },
            axisLabel: {
              fontSize: "80%"
            }
          }
        ,
        yAxis:
          {
            type: 'value',
            scale: true,
            axisTick: {
              show: false
            },
            axisLabel: {
              fontSize: "80%",
              formatter:'{value} %'
            }
          }
        ,
        series: [
          {
            name: "计划热值",
            type: 'bar',
            barWidth: '10%',
            data: datainfo.ydata,
            label:{
              show:true,
              fontSize:"80%",
              position:"top",
              formatter:'{c} %'
            },
            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
              offset: 0,
              color: '#65E0F5'
            }, {
              offset: 1,
              color: '#56C6D3'
            }]),
          }
        ]
      };
      myChart.setOption(option);
      window.addEventListener("resize", function () {
        myChart.resize();
      });
      
    //-------------------------柱子点击变色并传参---------------
      myChart.on('click', function (params) {

        //console.log(params);

        var index = params.dataIndex;
        var name = params.name;
        //console.log(datainfo.ydata[i] )

        for (var i = 0; i < datainfo.ydata.length; i++) {
          if (datainfo.ydata[i].value) {
            datainfo.ydata[i] = datainfo.ydata[i].value;
          }
          if (index == i) {
            datainfo.ydata[i] = {
              value: datainfo.ydata[i],
              itemStyle: {
                normal: {
                  color:'#F1A267'
                }
              }
            }
          }
        }

        //console.log(datainfo.ydata);
        option.series[0].data = datainfo.ydata
        myChart.setOption(option, true);
      })
    }


    var drawBar8 = function (datainfo) {
      var myChart = echarts.init(document.getElementById("bar_8"));
      var option = {
        title: {
          text: '2018-03各电厂到货率情况',
          x: 'center',
          y: '5%',
          textStyle: {
            fontSize: "120%",
          }
        },
        tooltip: {
          trigger: 'axis',
          axisPointer: {            // 坐标轴指示器，坐标轴触发有效
            type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
          }
        },
        grid: {
          left: '4%',
          right: '2%',
          top: '25%',
          bottom: '16%',
          containLabel: true
        },
        xAxis:
          {
            data: datainfo.xdata,
            axisTick: {
              show: false
            },
            axisLabel: {
              fontSize: "80%",
              rotate:90
            }
          }
        ,
        yAxis:
          {
            type: 'value',
            scale: true,
            axisTick: {
              show: false
            },
            axisLabel: {
              fontSize: "80%",
              formatter:'{value} %'
            }
          }
        ,
        series: [
          {
            name: "计划热值",
            type: 'bar',
            barWidth: '10%',
            data: datainfo.ydata,
            label:{
              show:true,
              fontSize:"80%",
              position:"top",
              formatter:'{c} %'
            },
            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
              offset: 0,
              color: '#65E0F5'
            }, {
              offset: 1,
              color: '#56C6D3'
            }]),
          }
        ]
      };
      myChart.setOption(option);
      window.addEventListener("resize", function () {
        myChart.resize();
      });
      
    //-------------------------柱子点击变色并传参---------------
      myChart.on('click', function (params) {

        //console.log(params);

        var index = params.dataIndex;
        var name = params.name;
        //console.log(datainfo.ydata[i] )

        for (var i = 0; i < datainfo.ydata.length; i++) {
          if (datainfo.ydata[i].value) {
            datainfo.ydata[i] = datainfo.ydata[i].value;
          }
          if (index == i) {
            datainfo.ydata[i] = {
              value: datainfo.ydata[i],
              itemStyle: {
                normal: {
                  color:'#F1A267'
                }
              }
            }
          }
        }

        //console.log(datainfo.ydata);
        option.series[0].data = datainfo.ydata
        myChart.setOption(option, true);
      })
    }


</script>